<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.1, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="IRONCLAD CRM">
  <meta name="apple-mobile-web-app-status-bar" content="#ffffff">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">

  <!-- Apple Splash Screens (iPad portrait) -->
  <link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-2048x2732.png">
  <link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-1668x2388.png">
  <link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-1536x2048.png">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="../favicon.png">
  <link rel="icon" type="image/png" href="../favicon.png">
  <link rel="shortcut icon" href="../favicon.png">

  <link rel="manifest" href="../manifest.json">
  <link rel="apple-touch-icon" href="../img/icons/apple-touch-icon.png">
  <link rel="stylesheet" href="../css/styles.css">
  
  <!-- Print to PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <title>IRONCLAD CRM</title>
</head>

<body>
    <header>
        <a href="../settings.html" class="settings"></a>
        <img src="../img/icons/logo.png">
        <h2>Project Manager</h2>
    </header>

    <main>
        <div class="button-space">
            <button class="wide-button" onclick="goToPage('/projects.html')">My Projects</button>
            <button class="wide-button" onclick="goToPage('/newProject.html')">New Project</button>
        </div>

      <img src="../img/background.png" alt="Background" style="margin:auto;">
      <!-- Add more images from your img/ folder -->

        <p style="color: rgb(100, 100, 100);">Software <span id="sw-version">Version 4.1 â€¢ Updated January 2026</span><br>Written by Nathan Green</p>
        <img src="/IRONCLAD/img/icons/print.png" id="print-icon" onclick="savePageAsPDF()" style="
            height: 50px;
            width: 50px;
            right: 50px;
            display: block;
            position: absolute;
            bottom: 0;
            display: none;
        ">
    </main>

    <footer>
        <!-- Toggle Switch -->
        <div class="toggle-container">

            <label class="switch">
                <input type="checkbox" id="featureToggle">
                <span class="slider round"></span>
            </label>
            <span class="toggle-label">Test Mode</span> <!-- "Stay Logged In" -->
            <span class="status" id="status">Off</span>
        </div>

        <p id="featureMessage" style="margin-top: 2rem; font-size: 1.1rem; color: #555;">
            The experimental feature is currently <strong>disabled</strong>.
        </p>
    </footer>

    <!-- Firestore Database ("Live") -->
  <script type="module" src="../js/modules.js"></script>
  
  <!-- Local Database ("Test Mode") -->
  <script src="/IRONCLAD/js/db.js"></script>
  
  <!-- Link JavaScript -->
  <script src="/IRONCLAD/js/app.js"></script>

    <script>
        // === Feature Toggle Logic ===
        const toggle = document.getElementById('featureToggle');
        const status = document.getElementById('status');
        const message = document.getElementById('featureMessage');
        const printIco = document.getElementById('print-icon');

        // Load saved state (if any)
        if (localStorage.getItem('TestMode') === 'true') {
            toggle.checked = true;
            status.textContent = 'On';
            message.innerHTML = 'The experimental feature is currently <strong style="color:green">enabled</strong>.';
            
            printIco.style.display = "block";
        }

        // Listen for changes
        toggle.addEventListener('change', function () {
            if (this.checked) {
                localStorage.setItem('TestMode', 'true');
                status.textContent = 'On';
                message.innerHTML = 'The experimental feature is currently <strong style="color:green">enabled</strong>.';
                document.body.classList.toggle("tron-mode", true);

                printIco.style.display = "block";
            } else {
                localStorage.setItem('TestMode', 'false');
                status.textContent = 'Off';
                message.innerHTML = 'The experimental feature is currently <strong>disabled</strong>.';
                document.body.classList.toggle("tron-mode", false);

                printIco.style.display = "none";
            }
        });
    </script>

    <!-- Print Screen to PDF -->
    <script>
        // Very clean usage
        async function savePageAsPDF() {
            const element = document.body;
            var fileName = window.prompt("Save file as:");
            if (!fileName) {return};

            const opt = {
                margin: 0.5,                       // inches
                filename: fileName/*'my-page.pdf'*/,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true }, // better quality + external images
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };

            try {
                await html2pdf().set(opt).from(element).save();
                console.log('PDF saved successfully');
            } catch (err) {
                console.error('PDF generation failed:', err);
            }
        }

        // Usage: button click, etc.
        document.getElementById('savePdfBtn').addEventListener('click', savePageAsPDF);
    </script>

</body>

</html>