<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.1, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="IRONCLAD CRM">
  <meta name="apple-mobile-web-app-status-bar" content="#ffffff">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">

  <!-- Apple Splash Screens (iPad portrait) -->
  <link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-2048x2732.png">
  <link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-1668x2388.png">
  <link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-1536x2048.png">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="../favicon.png">
  <link rel="icon" type="image/png" href="../favicon.png">
  <link rel="shortcut icon" href="../favicon.png">

  <link rel="manifest" href="../manifest.json">
  <link rel="apple-touch-icon" href="../img/icons/apple-touch-icon.png">
  <link rel="stylesheet" href="../css/styles.css">

  <title>IRONCLAD CRM</title>
</head>

<body>
    <header>
        <img src="../img/icons/logo.png">
        <h2>Project Information</h2>
    </header>

    <main>
        <form id="project-form">
            <table>
                <tdata>
                    <tr><th><span>Item</span></th><th><span>Color / Style</span></th></tr>
                    <tr><td><span>Shingle</span></td><td><select name="shingle"></select></td></tr>
                    <tr><td><span>Starter</span></td><td><select name="starter"></select></td></tr>
                    <tr><td><span>Drip Edge</span></td><td><select name="drip_edge"></select></td></tr>
                    <tr><td><span>Gutter Apron</span></td><td><select name="gutter_apron"></select></td></tr>
                    <tr><td><span>Flashing</span></td><td><select name="flashing"></select></td></tr>
                    <tr><td><span>Pipe Boots</span></td><td><select name="pipe_boots"></select></td></tr>
                    <tr><td><span>Broan Vents</span></td><td><select name="broan_vents"></select></td></tr>
                    <tr><td><span>Chimney</span></td><td><select name="chimney"></select></td></tr>
                    <tr><td><span>Wall Flashing</span></td><td><select name="wall_flashing"></select></td></tr>
                </tdata>
            </table>
        </form>
        <!-- Toggle Partial Roof -->
        <div class="toggle-container full">
            <label class="switch">
                <input type="checkbox" id="roofPartial" data-target="roof-partial">
                <span class="slider round"></span>
            </label>
            <span class="toggle-label">Partial Roof</span>
            <span class="status" id="status">Not Included</span>
        </div>

        <!-- Toggle Repair Roof -->
        <div class="toggle-container full">
            <label class="switch">
                <input type="checkbox" id="roofRepair" data-target="roof-repair">
                <span class="slider round"></span>
            </label>
            <span class="toggle-label">Repair</span>
            <span class="status" id="status">Not Included</span>
        </div>



        <p style="color: rgb(100, 100, 100);">Version 1.0 • Updated November 2025<br>Written by Nathan Green</p>
    </main>

    <footer>
        <div class="bottom-nav">
            <button class="" onclick="goToPage('/newProject.html')">◄ Back</button>
            <button class="" onclick="goToPage(location.href='/roofDefinitions.html')">Next ►</button>
        </div>
    </footer>


    <!-- Firestore Database ("Live") -->
    <script type="module" src="../js/modules.js"></script>
  
    <!-- Local Database ("Test Mode") -->
    <script src="/IRONCLAD/js/db.js"></script>
  
    <!-- Link JavaScript -->
    <script src="/IRONCLAD/js/app.js"></script>

    <!-- Page JavaScript -->
    <script>
        // Populate Form
        var form = document.getElementById("project-form");

        fetch('../data/material.json')
            .then(response => response.json())
            .then(data => {
                console.log(data)
                // Use the 'data' array here with the same forEach loop
                data.Shingles.forEach(itemData => { // Shingles
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.shingle.appendChild(list);
                });
                data.Starter.forEach(itemData => { // Starter
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.starter.appendChild(list);
                });
                data.DripEdge.forEach(itemData => { // Drip Edge
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.drip_edge.appendChild(list);
                });
                data.GutterApron.forEach(itemData => { // Gutter Apron
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.gutter_apron.appendChild(list);
                });
                data.Flashing.forEach(itemData => { // Flashing
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.flashing.appendChild(list);
                });
                data.PipeBoots.forEach(itemData => { // Pipe Boots
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.pipe_boots.appendChild(list);
                });
                data.BroanVents.forEach(itemData => { // Broan Vents
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.broan_vents.appendChild(list);
                });
                data.Chimney.forEach(itemData => { // Chimney(s)
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.chimney.appendChild(list);
                });
                data.WallFlashing.forEach(itemData => { // Wall Flashing
                    let list = document.createElement("option");
                    list.innerHTML = itemData.name;
                    form.wall_flashing.appendChild(list);
                });
            })
    .catch(error => console.error('Error fetching data:', error));


        // === Feature Toggle Logic ===
        const switches = document.querySelectorAll('.switch');
        const status = document.getElementById('status');
        const message = document.getElementById('featureMessage');

        switches.forEach(lbl => {
            let cb = lbl.firstElementChild;
            showHideContent(cb.getAttribute("data-target"));

            // Listen for changes
            cb.addEventListener('change', function (evt) {
                let $this = evt.target;
                if ($this.checked) {
                    myAttribute = $this.id;
                    localStorage.setItem($this.id, 'true');
                    status.textContent = 'Included';
                    showHideContent($this.getAttribute('data-target'), true);
                } else {
                    localStorage.setItem($this.id, 'false');
                    status.textContent = 'Not Included';

                    //initialize hidden
                    showHideContent($this.getAttribute('data-target'), false);
                }
            });
        })

        function showHideContent(target, bool) {
            let el = document.querySelector(`#${target}`);
            let container = el.parentElement;
            
            if(bool) {
                container.style.visibility = "visible";
                container.style.height = "auto";
                container.style.opacity = 1;
                container.style.transition = "opacity .5s";
            } else {
                container.style.visibility = "hidden";
                setTimeout(function(){container.style.height = "0px";}, 400);
                container.style.opacity = 0;
                container.style.transition = "opacity 350ms";
            }
        }

        // Load saved state (if any)
        if (localStorage.getItem('featureEnabled') === 'true') {
            toggle.checked = true;
            status.textContent = 'On';
            message.innerHTML = 'The experimental feature is currently <strong style="color:green">enabled</strong>.';
        }

        
    </script>

</body>

</html>