<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.1, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="IRONCLAD CRM">
  <meta name="apple-mobile-web-app-status-bar" content="#ffffff">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">

  <!-- Apple Splash Screens (iPad portrait) -->
  <link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-2048x2732.png">
  <link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-1668x2388.png">
  <link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="../img/splash/splash-1536x2048.png">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="../favicon.png">
  <link rel="icon" type="image/png" href="../favicon.png">
  <link rel="shortcut icon" href="../favicon.png">

  <link rel="manifest" href="../manifest.json">
  <link rel="apple-touch-icon" href="../img/icons/apple-touch-icon.png">
  <link rel="stylesheet" href="../css/styles.css">

  <title>IRONCLAD CRM</title>
</head>

<body>
    <header>
        <img src="../img/icons/logo.png">
        <h2>My Projects</h2>
    </header>


    <main>
        <table class="first-column-locked">
            <tbody>
                <tr>
                    <th>Customer</th>
                    <th>Type</th>
                    <th>Project Owner</th>
                    <th>Status</th>
                </tr>
                <tr>
                    <td>Nate Green</td>
                    <td>Roof</td>
                    <td>Jon Wright</td>
                    <td>
                        <select class="projectStatus">

                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Nancy Green</td>
                    <td>Roof + Siding</td>
                    <td>Jon Wright</td>
                    <td>
                        <select class="projectStatus">
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>John Doe</td>
                    <td>Roof</td>
                    <td>Jon Wright</td>
                    <td>
                        <select class="projectStatus">
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Bob Smith</td>
                    <td>Roof</td>
                    <td>Matt Green</td>
                    <td>
                        <select class="projectStatus">
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Bugs Bunny</td>
                    <td>Roof + Siding + Gutters</td>
                    <td>Jon Wright</td>
                    <td>
                        <select class="projectStatus">
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>Fred Flinstone</td>
                    <td>Roof</td>
                    <td>Jon Wright</td>
                    <td>
                        <select class="projectStatus">
                        </select>
                    </td>
                </tr>
            </tbody>
        </table>
        <!-- Test Changes to Status Bar Background
        <div class="button-space">
            <button onclick="setThemeColor('#FF0000')">Red</button>
            <button onclick="setThemeColor('#FFFFFF')">White</button>
            <button onclick="setThemeColor('#0000FF')">Blue</button>
        </div> -->
    </main>

    <footer>
        <div class="button-space">
            <button onclick="location.href='home.html'">Home</button>
        </div>
    </footer>

    <script type="module">
        
    </script>

    <!-- Firestore Database ("Live") -->
    <script src="../js/modules.js"></script>

    <!-- Local Database ("Test Mode") -->
    <script src="../js/db.js"></script>
    
    <!-- Link JavaScript -->
    <script src="../js/app.js"></script>

    <script>
        const REPO = "/IRONCLAD";

        function updateProjectTable(data) {
            var selects = document.querySelectorAll('.projectStatus');
            selects.forEach(select => {
                data.forEach(text => {
                    let opt = document.createElement('option');
                    opt.value = text;       // or opt.value = text.toLowerCase() if you want different values
                    opt.textContent = text;
                    select.appendChild(opt);
                });
            })
        }

        function projectStatus() {
            fetch(REPO + '/data/project_status.json')
                .then(res => res.ok ? res.json() : Promise.reject('Offline or error'))
                .then(data => updateProjectTable(data))
                .catch(err => {
                    if (err === 'Offline or error') {
                        // Load from localStorage fallback or show cached
                        const cached = JSON.parse(localStorage.getItem('lastProjects') || '[]');
                        updateProjectTable(cached);
                        document.body.classList.add('offline-mode'); // Style dimmed
                    }
                });
        }

        projectStatus();
    </script>
    <script>

        // <meta name="apple-mobile-web-app-status-bar" content="#ffffff">
        // THEME COLOR
        function setThemeColor(color) {
            document.body.style.backgroundColor = color;
            /*
            let themeColorMeta = document.querySelector('meta[name="theme-color"]');
        if (!themeColorMeta) {
            themeColorMeta = document.createElement('meta');
            themeColorMeta.name = 'theme-color';
            document.head.appendChild(themeColorMeta);
        }
        themeColorMeta.content = color;*/
        }
    </script>
</body>

</html>